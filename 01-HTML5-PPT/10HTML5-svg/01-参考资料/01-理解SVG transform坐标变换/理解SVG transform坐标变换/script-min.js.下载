(function(){var e={$:function(e){return document.getElementById(e)},hd:function(e){e.style.display="none"},sh:function(e){e.style.display="block"}};if(!document.querySelector){document.querySelector=function(){return null}}var t=e.$("footYYShow"),n=e.$("footYyX"),i=e.$("footYYOff"),r=e.$("footYYClose");t.onclick=function(){e.sh(n);return false};i.onclick=function(){e.hd(n);return false};r.onclick=function(){e.hd(n);return false};var a=e.$("page");e.$("backToTop").onclick=function(){document.documentElement.scrollTop=0;document.body.scrollTop=0;return false};var o=e.$("content").getElementsByTagName("img"),s=o.length;var l=[];for(var c=0;c<s;c++){if(!o[c].src){l.push({src:o[c].getAttribute("data-src"),obj:o[c]})}}if(a){var d=function(){for(var e=0;e<l.length;e++){(function(e){if(l[e].src){var t=l[e].obj.getBoundingClientRect(),n=l[e].src;if(t.top>t.top-t.bottom&&t.top<(window.innerHeight||screen.availHeight-40)){if(typeof document.webkitHidden!="undefined"&&window.Promise){var i=new Image;i.onload=function(){l[e].obj.src=n;l[e].obj.removeAttribute("data-src")};i.src=n}else{l[e].obj.src=n;l[e].obj.removeAttribute("data-src")}l[e].src=""}}})(e)}};a.onscroll=function(){d()};document.onscroll=function(){d()};d()}var f=e.$("content").getElementsByTagName("div"),u=f.length,m,p,v;for(var h=0;h<u;h+=1){if(!m&&(f[h].className==="similarity"||f[h].className==="wp_share_box")){m=f[h]}}if(m){var y=m.previousElementSibling;if(screen.width>640){if(y&&/本篇/.test(y.innerHTML)){y.innerHTML+='<span class="ins_txt">// 想要打赏？点击<a href="javascript:" id="alipayA" title="点击显示二维码">这里</a>。有话要说？点击<a href="#comment" title="点击定位到评论">这里</a>。</span>';e.$("alipayA").onclick=function(){var t=e.$("payOverlay");if(t){t.style.display="block"}else{document.body.insertAdjacentHTML("beforeEnd",'<div id="payOverlay" class="yw_overlay" onclick="this.style.display=\'none\';"><div class="alipay_support"><strong>支付宝<span style="margin:0 82px;"></span>微&nbsp;&nbsp;信</strong><div class="alipay_img"><img src="http://www.zhangxinxu.com/alipay.png"> <img src="http://www.zhangxinxu.com/wxpay.png"></div></div></div>')}if(window._gaq){_gaq.push(["_trackEvent","PAY","click","will overlay"])}}}v=e.$("daITxz");if(v){m.parentNode.insertBefore(v,m)}}else{if(/MicroMessenger/i.test(navigator.userAgent)&&y&&/本篇/.test(y.innerHTML)){y.className="payimg";y.innerHTML='<span>写得666！赏一下（长按识别）：</span><img src="/wxpay-24.png" width="198" height="198">'}}}if(document.querySelectorAll){var g=document.querySelectorAll(".entry > p > a");for(var T=0;T<g.length;T++){if(g[T].parentNode.className!="link"&&!/tag/.test(g[T].href)){g[T].target="_blank"}}}var b=e.$("commentform"),w=e.$("submit");if(b&&w){var N=b.querySelector("#author"),L=b.querySelector("#email"),$=b.querySelector("#url"),H=b.querySelector("#comment");var S="placeholder";if(screen.width<640&&b.classList){b.classList.add("mobile");if(N){N.setAttribute(S,"名称(必须)")}if(L){L.setAttribute(S,"邮箱(必须)")}if($){$.setAttribute(S,"网站(可选)")}if(H){H.setAttribute(S,"评论内容(必须)")}}w.insertAdjacentHTML("afterend",'<span id="commRem" class="ml20" style="color:#cd0000;"></span>');var x=e.$("commRem");if("".trim&&N&&L&&$&&H){b.addEventListener("submit",function(e){var t=true;if(N.value.trim()==""){x.innerHTML="名称还没填写";t=false}else if(L.value.trim()==""){x.innerHTML="邮箱还没填写";t=false}else if(H.value.trim()==""){x.innerHTML="评论内容还没填写";t=false}if(t==false){e.preventDefault();return false}x.style.color="";x.innerHTML="正在提交中..."});b.addEventListener("input",function(){x.innerHTML=""})}if(document.querySelector){var M=document.querySelector("h3.respond_title");if(M){M.innerHTML=M.innerHTML.replace(/\s+/g,"")}}var k=e.$("comments");if(k&&screen.width<640&&/\d|一/.test(k.innerHTML)){w.parentNode.insertAdjacentHTML("afterend",'<p class="da_no_away">//zxx: 翻过下面几座小山就能看到精彩评论</p>')}}var _=e.$("respond"),q=document.querySelector(".post");if(screen.width<640&&_&&q){_.parentNode.insertBefore(_,q.nextSibling)}var A=document.querySelector(".top_da_out"),E=e.$("sidebar");if([].map&&screen.width>640){if(A&&E){var j=E.clientHeight+E.offsetTop,C=E.offsetTop;var Y=A.offsetTop-10;var B=false;document.addEventListener("scroll",function(){if(/open/.test(A.className)){A.style.position="";A.style.top="";A.style.left="";A.style.right="";return}var e=this.body.scrollTop||this.documentElement.scrollTop||0;var t=B?1599:this.documentElement.clientWidth;if(t>=1600&&e>=Y||t<1600&&e>j){A.style.position="fixed";A.style.top="10px"}else{A.style.position="";A.style.top=""}if(e>j&&t>=1600){A.style.left="auto";A.style.top="10px";A.style.right="10px"}else{A.style.left="";A.style.right=""}})}}var I=e.$("slideA");if(I&&A){I.addEventListener("click",function(){if(this.innerHTML=="收起"){A.className=A.className.replace(" open","");this.innerHTML="展开"}else{A.className=A.className+" open";this.style.display="none"}})}var z=e.$("shinkSlide"),D=e.$("page"),W=window.localStorage;if(z&&D&&screen.width<1680){z.style.display="inline";z.onclick=function(){var e=D.className,t=this.title;if(/slide_hide/.test(e)){D.className=(" "+e+" ").replace(/\s+slide_hide\s+/,"");this.title=t.replace("展开","收起");this.innerHTML="&#x25ba;";if(W){localStorage.removeItem("slideHideTime")}}else{D.className=e+" slide_hide";this.title=t.replace("收起","展开");this.innerHTML="&#x25c4;";if(W){localStorage.setItem("slideHideTime",+new Date)}}this.blur();return false}}var F=e.$("footbar");var O=function(t,n){var i=e.$(t),r=i.eleClone;if(!r){r=i.cloneNode(true);r.id=t+"Float";r.className+=" hidden";i.eleClone=r;document.body.appendChild(r);r.onmouseover=function(e){e=e||window.event;var t=e.target;if(t&&/hidden/.test(t.className)&&t.tagName.toLowerCase()=="a"){return}this.style.bottom="0px"};r.querySelector(".jsFC").addEventListener("click",function(){O(t,"out");localStorage["ad"+t]=+new Date;clearTimeout(G)});var a=document.querySelector("#"+t+"Float > a");if(a){a.setAttribute("onclick",a.getAttribute("onclick").replace("Not ",""))}}n=n||"into";if(F&&i){if(n=="into"){F.className="slideout";r.style.display="block"}else{F.className="";r.style.display="none"}}};var R=["daYideng","daITxz","daMW"].sort(function(){return Math.random()<=.5?1:-1}),X=0;var P=false;if([].map&&screen.width>1e3){var G=null;document.addEventListener("scroll",function(){clearTimeout(G);var t=R[X];if(!t||!e.$(t)){return}var n=localStorage["ad"+t],i=document.documentElement.scrollTop||document.body.scrollTop;if(n){var r=+new Date;if(t=="adYideng"&&r-n*1<864e5*3||t!="adYideng"&&r-n*1<864e5*30){X++;return}}var a=e.$(t),o=a.offsetTop<i+window.innerHeight;var s=a.eleClone;if(s){if(o){O(t,"out")}else{O(t)}}else if(P!=true){G=setTimeout(function(){if(!o){O(t);P=true}},6e3)}})}var J=screen.width,K=e.$("qrCode");if(J>480&&K){setTimeout(function(){K.innerHTML='<img src="http://qr.liantu.com/api.php?text='+location.href+'">'},3e3)}var Q=e.$("adSlideX"),U=e.$("adIndexX");if(Q&&U){var V=U.getElementsByTagName("a");var Z=V.length;var ee=null,te=0,ne=Q.parentNode.clientWidth||336;var ie=false;var re=[5e3,5e3,5e3];var ae=function(){if(!A||/open/.test(A.className)){return}Q.style.left=-1*te*ne+"px";se()},oe=function(){ee=setTimeout(function(){te++;if(te>=Z){te=0}ae();oe()},re[te])},se=function(){for(var e=0;e<Z;e++){V[e].className="da_index_a"}if(V[te]){V[te].className="da_index_a active"}};if(screen.width>640){for(var le=0;le<Z;le++){V[le].onmouseover=function(){te=this.innerHTML*1-1;ae()}}Q.parentNode.onmouseover=function(){clearTimeout(ee)};Q.parentNode.onmouseout=function(){oe()}}oe()}var ce=e.$("iconSearch"),de=null,fe=false;if(ce&&ce.clientWidth){ce.onclick=function(){var t=this.getAttribute("href");de=document.querySelector(t);if(de){e.hd(this);if(!fe){this.parentNode.appendChild(de);fe=true}else{e.sh(de)}de.querySelector("#s").focus()}return false};D&&D.addEventListener("click",function(t){var n=t.target.tagName.toLowerCase();if(n!="a"&&n!="input"&&fe==true){e.hd(de);e.sh(ce)}})}})();